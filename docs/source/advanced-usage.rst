Advanced Usage
==============

Customize Bitstring by Omitting Specific Interactions
-----------------------------------------------------

It is possible to omit certain interaction(s) in selected residue(s).
This will cause PyPLIF HIPPOS to replace the omitted interaction in the bitstring
with ``n`` character (eg. from ``1010001`` to ``1n10001``). As a consequence, the omitted
interaction will not be included in similarity calculation. This is done by
removing the omitted interaction bit both in the target and the reference bitstring. As
a result the similarity coefficient could be different from the default one.

To omit interaction just add the following line to the configuration file:

``omit_interaction interaction_type residue_name [single or multiple]``

where ``interaction_type`` is one of the following value:

- ``hydrophobic`` or ``HPB``
- ``aromatic`` or ``ARM``
- ``h_bond`` or ``HBD``
- ``electrostatic`` or ``ELE``
- ``h_bond_donor`` or ``HBD_DON``
- ``h_bond_acceptor`` or ``HBD_ACC``
- ``electrostatic_positive`` or ``ELE_POS``
- ``electrostatic_negative`` or ``ELE_NEG``
- ``aromatic_facetoface`` or ``ARM_F2F``
- ``aromatic_edgetoface`` or ``ARM_E2F``

As for the ``residue_name`` it could be one or more residue name. Here is
one example of a valid omit_interaction definition:

``omit_interaction hydrophobic ARG223``

As a quick start here is three different scenario on omitting interaction.

Omit single interaction
^^^^^^^^^^^^^^^^^^^^^^^

This configuration file (`examples-input/08-na_omit_interaction/vina-omit-simple.txt`)
shows how you can omit hydrophobic interaction on ARG223 residue ::

    docking_method    vina    # plants or vina
    docking_conf      ../03-na_vina/vina-003.conf

    similarity_coef   tanimoto mcconnaughey

    full_ref  00000100000000000000000000000000000100000000000001000000000000010000001000000000000000000001000000000000000000000000000000101000000000000000000101000000000010000  00010101000000000000000000000000000100000000000001010000000000010000001000000000000010000000000000000000000001011000001000001000000000000000000101000000000000000  00010101000000100000000000000000000100000000000001010000000000010000001000000000000010000001000000000000010000000000100000101010000000000000000001000000000000000

    omit_interaction  hydrophobic  ARG223

    residue_name ARG116 GLU117 LEU132 LYS148 ASP149 ARG150 ARG154 TRP177 SER178 ILE221 ARG223 THR224 GLU226 ALA245 HIS273 GLU275 GLU276 ARG292 ASP294 GLY347 ARG374 TRP408 TYR409
    residue_number 40 41 56 72 73 74 78 101 102 145 147 148 150 169 197 199 200 216 218 271 298 332 333

    full_outfile omit-simple.csv
    sim_outfile omit-simple-similarity.csv
    logfile omit-simple.log

Here is the excerpt from the bitstring output using the above configuration file ::

    129821_1         -6.9      0000000100000000000000000000100000010010000000000000000000000001000000n000000000000010000001000000000000000000000000000000100000000010000000000100000000000001000
    129821_2         -6.8      0000000000000000000000000000000000010000000000000101000000000001000000n000000000000000000001000000000000000001010000000000100000000010000000000000000000000001000
    129821_3         -6.6      0000000000000000000000000000100000110000000000000101000000000001000000n000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000
    129821_4         -6.4      0000000000000000000000000000100010000000000000000000000000000001000000n000000000000000000001000000000000000000010000101000000000000000000000000000000000000000000
    129821_5         -6.2      0000000000000000000000000000100000010000000000000101000000000001000000n000000000000000000001000000000000000000000000000000000000001010000000000100000000000001000

Notice that there is an ``n`` character that replace one of the bit.

Omit single interaction in several residue
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

The following configuration file (`examples-input/08-na_omit_interaction/vina-omit-residues.txt`)
shows how you can omit hydrophobic interaction on ARG150 TRP177 ARG223 residues ::

    docking_method    vina    # plants or vina
    docking_conf      ../03-na_vina/vina-003.conf

    similarity_coef   tanimoto mcconnaughey

    full_ref  00000100000000000000000000000000000100000000000001000000000000010000001000000000000000000001000000000000000000000000000000101000000000000000000101000000000010000  00010101000000000000000000000000000100000000000001010000000000010000001000000000000010000000000000000000000001011000001000001000000000000000000101000000000000000  00010101000000100000000000000000000100000000000001010000000000010000001000000000000010000001000000000000010000000000100000101010000000000000000001000000000000000

    omit_interaction  hydrophobic  ARG150 TRP177 ARG223

    residue_name ARG116 GLU117 LEU132 LYS148 ASP149 ARG150 ARG154 TRP177 SER178 ILE221 ARG223 THR224 GLU226 ALA245 HIS273 GLU275 GLU276 ARG292 ASP294 GLY347 ARG374 TRP408 TYR409
    residue_number 40 41 56 72 73 74 78 101 102 145 147 148 150 169 197 199 200 216 218 271 298 332 333

    full_outfile omit-residues.csv
    sim_outfile omit-residues-similarity.csv
    logfile omit-residues.log

Here is the excerpt from the bitstring output using the above configuration file ::

    129821_1         -6.9      00000001000000000000000000001000000n0010000000000n00000000000001000000n000000000000010000001000000000000000000000000000000100000000010000000000100000000000001000
    129821_2         -6.8      00000000000000000000000000000000000n0000000000000n01000000000001000000n000000000000000000001000000000000000001010000000000100000000010000000000000000000000001000
    129821_3         -6.6      00000000000000000000000000001000001n0000000000000n01000000000001000000n000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000
    129821_4         -6.4      00000000000000000000000000001000100n0000000000000n00000000000001000000n000000000000000000001000000000000000000010000101000000000000000000000000000000000000000000
    129821_5         -6.2      00000000000000000000000000001000000n0000000000000n01000000000001000000n000000000000000000001000000000000000000000000000000000000001010000000000100000000000001000

Notice that there are three ``n``, each of them replace hydrophobic interaction in one residue.

Omit more than one interaction
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

And here is how you can omit more than one interaction, this configuration file
(`examples-input/08-na_omit_interaction/vina-omit-interactions.txt`) shows you how
to omit the hydrophobic interaction on ARG223 and hydrogen bond (both as donor and acceptor) on
ARG292 ::

    docking_method    vina    # plants or vina
    docking_conf      ../03-na_vina/vina-003.conf

    similarity_coef   tanimoto mcconnaughey

    full_ref  00000100000000000000000000000000000100000000000001000000000000010000001000000000000000000001000000000000000000000000000000101000000000000000000101000000000010000  00010101000000000000000000000000000100000000000001010000000000010000001000000000000010000000000000000000000001011000001000001000000000000000000101000000000000000  00010101000000100000000000000000000100000000000001010000000000010000001000000000000010000001000000000000010000000000100000101010000000000000000001000000000000000

    omit_interaction  hydrophobic  ARG223
    omit_interaction  h_bond  ARG292

    residue_name ARG116 GLU117 LEU132 LYS148 ASP149 ARG150 ARG154 TRP177 SER178 ILE221 ARG223 THR224 GLU226 ALA245 HIS273 GLU275 GLU276 ARG292 ASP294 GLY347 ARG374 TRP408 TYR409
    residue_number 40 41 56 72 73 74 78 101 102 145 147 148 150 169 197 199 200 216 218 271 298 332 333

    full_outfile omit-interactions.csv
    sim_outfile omit-interactions-similarity.csv
    logfile omit-interactions.log

Here is the excerpt from the bitstring output using the above configuration file ::

    129821_1         -6.9      0000000100000000000000000000100000010010000000000000000000000001000000n000000000000010000001000000000000000000000000000000nn0000000010000000000100000000000001000
    129821_2         -6.8      0000000000000000000000000000000000010000000000000101000000000001000000n000000000000000000001000000000000000001010000000000nn0000000010000000000000000000000001000
    129821_3         -6.6      0000000000000000000000000000100000110000000000000101000000000001000000n000000000000000000001000000000000000000000000000000nn0000000000000000000000000000000000000
    129821_4         -6.4      0000000000000000000000000000100010000000000000000000000000000001000000n000000000000000000001000000000000000000010000101000nn0000000000000000000000000000000000000
    129821_5         -6.2      0000000000000000000000000000100000010000000000000101000000000001000000n000000000000000000001000000000000000000000000000000nn0000001010000000000100000000000001000

Notice that there are three ``n``, the first one is replacing the hydrophobic interaction
on ARG223, while the second and third both are replacing the hydrogen bond interaction on
ARG292.